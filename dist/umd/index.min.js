!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).bundle=e()}(this,(function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function o(t){for(var o=1;o<arguments.length;o++){var r=null!=arguments[o]?arguments[o]:{};o%2?n(r,!0).forEach((function(n){e(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(r).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};const i="@@redux-api-middleware/RSAA";function a(t){return t&&"object"==typeof t&&Object.getPrototypeOf(t)===Object.prototype}function s(t){return a(t)&&t.hasOwnProperty(i)}function p(t){const e=["type","payload","meta"];if(!a(t))return!1;for(let n in t)if(!~e.indexOf(n))return!1;return"type"in t&&("string"==typeof t.type||"symbol"==typeof t.type)}function u(t){var e=[];const n=["endpoint","options","method","body","headers","credentials","bailout","types","fetch","ok"],o=["omit","same-origin","include"];if(!s(t))return e.push("RSAAs must be plain JavaScript objects with an [RSAA] property"),e;const r=t[i];a(r)||e.push("[RSAA] property must be a plain JavaScript object");for(let t in r)~n.indexOf(t)||e.push(`Invalid [RSAA] key: ${t}`);const{endpoint:u,method:f,headers:c,options:y,credentials:l,types:d,bailout:h,fetch:b,ok:m}=r;if(void 0===u?e.push("[RSAA] must have an endpoint property"):"string"!=typeof u&&"function"!=typeof u&&e.push("[RSAA].endpoint property must be a string or a function"),void 0===f?e.push("[RSAA] must have a method property"):"string"!=typeof f?e.push("[RSAA].method property must be a string"):~["GET","HEAD","POST","PUT","PATCH","DELETE","OPTIONS"].indexOf(f.toUpperCase())||e.push(`Invalid [RSAA].method: ${f.toUpperCase()}`),void 0===c||a(c)||"function"==typeof c||e.push("[RSAA].headers property must be undefined, a plain JavaScript object, or a function"),void 0===y||a(y)||"function"==typeof y||e.push("[RSAA].options property must be undefined, a plain JavaScript object, or a function"),void 0!==l&&("string"!=typeof l?e.push("[RSAA].credentials property must be undefined, or a string"):~o.indexOf(l)||e.push(`Invalid [RSAA].credentials: ${l}`)),void 0!==h&&"boolean"!=typeof h&&"function"!=typeof h&&e.push("[RSAA].bailout property must be undefined, a boolean, or a function"),void 0===d)e.push("[RSAA] must have a types property");else if(Array.isArray(d)&&3===d.length){const[t,n,o]=d;"string"==typeof t||"symbol"==typeof t||p(t)||e.push("Invalid request type"),"string"==typeof n||"symbol"==typeof n||p(n)||e.push("Invalid success type"),"string"==typeof o||"symbol"==typeof o||p(o)||e.push("Invalid failure type")}else e.push("[RSAA].types property must be an array of length 3");return void 0!==b&&"function"!=typeof b&&e.push("[RSAA].fetch property must be a function"),void 0!==m&&"function"!=typeof m&&e.push("[RSAA].ok property must be a function"),e}class f extends Error{constructor(t){super(),this.name="InvalidRSAA",this.message="Invalid RSAA",this.validationErrors=t}}class c extends Error{constructor(t){super(),this.name="InternalError",this.message=t}}class y extends Error{constructor(t){super(),this.name="RequestError",this.message=t}}class l extends Error{constructor(t,e,n){super(),this.name="ApiError",this.status=t,this.statusText=e,this.response=n,this.message=`${t} - ${e}`}}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),o.forEach((function(e){h(t,e,n[e])}))}return t}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}async function b(t){const e=t.headers.get("Content-Type");return!~[204,205].indexOf(t.status)&&e&&~e.indexOf("json")?await t.json():await Promise.resolve()}async function m(t,e=[]){try{t.payload="function"==typeof t.payload?await t.payload(...e):t.payload}catch(e){t.payload=new c(e.message),t.error=!0}try{t.meta="function"==typeof t.meta?await t.meta(...e):t.meta}catch(e){delete t.meta,t.payload=new c(e.message),t.error=!0}return t}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),o.forEach((function(e){g(t,e,n[e])}))}return t}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const S={ok:t=>t.ok,fetch:fetch};function w(t={}){const e=Object.assign({},S,t);return({getState:t})=>n=>o=>s(o)?(async()=>{const r=u(o);if(r.length){const t=o[i];if(t.types&&Array.isArray(t.types)){let e=t.types[0];e&&e.type&&(e=e.type),n({type:e,payload:new f(r),error:!0})}return}const a=o[i];var{endpoint:s,body:p,headers:h,options:g={},fetch:S=e.fetch,ok:w=e.ok}=a;const{method:v,credentials:O,bailout:R,types:j}=a,[P,E,x]=function(t){let[e,n,o]=t;return"string"!=typeof e&&"symbol"!=typeof e||(e={type:e}),"string"!=typeof n&&"symbol"!=typeof n||(n={type:n}),"string"!=typeof o&&"symbol"!=typeof o||(o={type:o}),[e,n=d({payload:(t,e,n)=>b(n)},n),o=d({payload:(t,e,n)=>b(n).then(t=>new l(n.status,n.statusText,t))},o)]}(j);try{if("boolean"==typeof R&&R||"function"==typeof R&&R(t()))return}catch(e){return n(await m(A({},x,{payload:new y("[RSAA].bailout function failed"),error:!0}),[o,t()]))}if("function"==typeof s)try{s=s(t())}catch(e){return n(await m(A({},x,{payload:new y("[RSAA].endpoint function failed"),error:!0}),[o,t()]))}if("function"==typeof p)try{p=p(t())}catch(e){return n(await m(A({},x,{payload:new y("[RSAA].body function failed"),error:!0}),[o,t()]))}if("function"==typeof h)try{h=h(t())}catch(e){return n(await m(A({},x,{payload:new y("[RSAA].headers function failed"),error:!0}),[o,t()]))}if("function"==typeof g)try{g=g(t())}catch(e){return n(await m(A({},x,{payload:new y("[RSAA].options function failed"),error:!0}),[o,t()]))}let T,k;"function"==typeof P.payload||"function"==typeof P.meta?n(await m(P,[o,t()])):n(P);try{T=await S(s,A({},g,{method:v,body:p||void 0,credentials:O,headers:h||{}}))}catch(e){return n(await m(A({},x,{payload:new y(e.message),error:!0}),[o,t()]))}try{k=w(T)}catch(e){return n(await m(A({},x,{payload:new c("[RSAA].ok function failed"),error:!0}),[o,t(),T]))}return n(k?await m(E,[o,t(),T]):await m(A({},x,{error:!0}),[o,t(),T]))})():n(o)}var v=Object.freeze({__proto__:null,RSAA:i,isRSAA:s,validateRSAA:u,isValidRSAA:function(t){return!u(t).length},InvalidRSAA:f,InternalError:c,RequestError:y,ApiError:l,getJSON:b,createMiddleware:w,apiMiddleware:function({getState:t}){return w()({getState:t})}});r.fetch=function(){};var O=v.RSAA;return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{endpoint:"/",types:[],method:"GET",body:{},headers:{}},r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t},s=n.types,p=[s[0],{type:s[1],payload:function(t,e,n){return i(t,e,n),n.json().then((function(t){return a(t)}))}},{type:s[2],meta:function(t,e,n){return i(t,e,n),n?{status:n.status,statusText:n.statusText}:{status:"Network request failed"}}}],u=r?n.body:JSON.stringify(n.body);return e({},O,{endpoint:n.endpoint||"",method:n.method||"GET",types:n.types?p:[],headers:o({},"object"===t(n.headers)?n.headers:{}),body:u})}}));
